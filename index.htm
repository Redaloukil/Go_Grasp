<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <title>Title</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.js'></script>
</head>
<body>



    <div id='map' style='display: flex; margin:auto;width: 1000px; height: 800px;'></div>
    <button onclick="getPath()">Search for path</button>
    <script>
        var path = []
        
        mapboxgl.accessToken = 'pk.eyJ1IjoicmVkYWEiLCJhIjoiY2p0cHIzaW5wMDdpejQzbTI2NGpnM215ciJ9.7BluMTtZtz62qn_SREi8ig';
        
        
        fetch("http://localhost:8000/grasp/").then((res)=>{
            var path = []
            res.json().then(element => {
                element.forEach(e => {
                    path.push([e.latitude , e.longitude]);
                    console.log(path);
                });
            })
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/streets-v11',
                center: [-0.70235107, 35.71077699 ],
                zoom: 10 // starting zoom
            });
            map.on('load',()=> {
            
            
            
 
            map.addLayer({
                "id": "route",
                "type": "line",
                "source": {
                "type": "geojson",
                "data": {
                "type": "Feature",
                "properties": {},
                "geometry": {
                "type": "LineString",
                "coordinates": path
            }
            }
            },
            "layout": {
                "line-join": "round",
                "line-cap": "round"
            },
            "paint": {
                "line-color": "#888",
                "line-width": 3,
            }

            })
            
            });
        })
        
    // function getPath() {
    //                 fetch("http://localhost:8000/grasp/")
    //                 .then(function (response){
    //                     if (response.status !== 200) {
    //                         console.log('Looks like there was a problem. Status Code: ' +
    //                                 response.status);
    //                         return;
    //                     }
    //                     // Examine the text in the response
    //                     response.json().then(function(data) {
    //                         data.map((elem)=>{
    //                             path.push([elem.latitude , elem.longitude]);

    //                         })
                            
    //                     });
    //                     updateMap(path)
    //                 }).   
    //                 catch(function (error){
    //                     console.log('Fetch Error :-S', err);

    //                 })

                    
                    
                    

    //     }
    
    
    </script>
</body>
</html>